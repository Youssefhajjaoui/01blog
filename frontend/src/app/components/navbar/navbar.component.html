<header class="navbar">
    <div class="nav-container">
        <div class="nav-content">
            <!-- Logo -->
            <button class="logo-btn" (click)="navigateToHome()">
                <div class="logo-icon">
                    <span class="logo-text">01</span>
                </div>
                <span class="logo-name">Blog</span>
            </button>

            <!-- Desktop Navigation Links -->
            <div class="nav-links">
                <button class="nav-link" [class.active]="currentPage === 'home'" (click)="navigateToHome()">
                    <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
                    </svg>
                    Home
                </button>
                <button class="nav-link" [class.active]="currentPage === 'editor'" (click)="navigateToEditor()">
                    <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                    </svg>
                    Write
                </button>
                <button *ngIf="isAdmin()" class="nav-link" [class.active]="currentPage === 'admin'"
                    (click)="navigateToAdmin()">
                    <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
                    </svg>
                    Admin
                </button>
            </div>

            <!-- Search Bar -->
            <div class="search-container">
                <svg class="search-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                </svg>
                <input type="search" class="search-input" placeholder="Search posts, users, tags..."
                    [(ngModel)]="searchQuery" (input)="onSearchChange($event)" (focus)="onSearchInputFocus()"
                    (blur)="onSearchInputBlur()" />

                <!-- Search Suggestions Dropdown -->
                <div class="search-suggestions" [class.show]="showSuggestions" (click)="$event.stopPropagation()">
                    <!-- Loading State -->
                    <div *ngIf="isLoadingSuggestions" class="suggestion-loading">
                        <div class="loading-spinner"></div>
                        <span>Searching...</span>
                    </div>

                    <!-- Suggestions List -->
                    <div *ngIf="!isLoadingSuggestions && suggestions.length > 0" class="suggestions-list">
                        <div *ngFor="let suggestion of suggestions" class="suggestion-item"
                            (click)="onSuggestionClick(suggestion, $event)">
                            <div class="suggestion-content">
                                <!-- User Avatar -->
                                <div class="suggestion-avatar" *ngIf="suggestion.type === 'user'">
                                    <img [src]="getUserAvatarUrl(suggestion)" [alt]="suggestion.username"
                                        class="avatar-img" />
                                </div>

                                <!-- User Icon for non-user suggestions -->
                                <div class="suggestion-icon" *ngIf="suggestion.type !== 'user'">
                                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                        *ngIf="suggestion.type === 'post'">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                                    </svg>
                                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                        *ngIf="suggestion.type === 'tag'">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M7 20l4-16m2 16l4-16M6 9h14M4 15h14" />
                                    </svg>
                                </div>

                                <!-- Suggestion Text -->
                                <div class="suggestion-text">
                                    <div class="suggestion-title">{{ suggestion.displayText }}</div>
                                    <div class="suggestion-subtitle" *ngIf="suggestion.subtitle">{{
                                        suggestion.subtitle
                                        }}</div>
                                </div>
                            </div>

                            <!-- Suggestion Type Badge -->
                            <div class="suggestion-type">
                                <span class="type-badge" [class]="'type-' + suggestion.type">
                                    {{ suggestion.type }}
                                </span>
                            </div>
                        </div>
                    </div>

                    <!-- No Results -->
                    <div *ngIf="!isLoadingSuggestions && suggestions.length === 0 && searchQuery.length >= 2"
                        class="no-results">
                        <svg class="no-results-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                        </svg>
                        <span>No users found for "{{ searchQuery }}"</span>
                    </div>
                </div>
            </div>

            <!-- Right Side Actions -->
            <div class="nav-actions">
                <!-- Notifications -->
                <div class="notification-container">
                    <button class="nav-action-btn notification-btn" (click)="onNotificationClick()">
                        <svg class="action-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" />
                        </svg>
                        <!-- Notification Counter -->
                        <span *ngIf="unreadCount > 0" class="notification-badge">{{ unreadCount > 99 ? '99+' :
                            unreadCount }}</span>
                    </button>

                    <!-- Notification Panel -->
                    <div class="notification-panel" [class.show]="showNotificationPanel"
                        (click)="$event.stopPropagation()">
                        <div class="notification-panel-header">
                            <h3 class="notification-panel-title">Notifications</h3>
                            <div class="notification-panel-actions" *ngIf="notifications.length > 0">
                                <button class="notification-action-btn" (click)="markAllNotificationsAsRead()"
                                    *ngIf="unreadCount > 0" title="Mark all as read">
                                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M5 13l4 4L19 7" />
                                    </svg>
                                </button>
                                <button class="notification-action-btn" (click)="clearAllNotifications()"
                                    title="Clear all">
                                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                                    </svg>
                                </button>
                            </div>
                        </div>

                        <div class="notification-panel-content">
                            <!-- No Notifications -->
                            <div *ngIf="notifications.length === 0" class="no-notifications">
                                <svg class="no-notifications-icon" fill="none" stroke="currentColor"
                                    viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" />
                                </svg>
                                <p>No notifications yet</p>
                            </div>

                            <!-- Notifications List -->
                            <div *ngIf="notifications.length > 0" class="notifications-list">
                                <div *ngFor="let notification of notifications" class="notification-item"
                                    [class.unread]="!notification.read"
                                    (click)="markNotificationAsRead(notification.id)">
                                    <div class="notification-content">
                                        <div class="notification-header">
                                            <h4 class="notification-title">{{ notification.title }}</h4>
                                            <span class="notification-time">{{
                                                formatNotificationDate(notification.creationDate) }}</span>
                                        </div>
                                        <p class="notification-message">{{ notification.content }}</p>
                                        <div class="notification-meta">
                                            <span class="notification-creator">by {{ notification.creatorName }}</span>
                                        </div>
                                    </div>
                                    <div class="notification-status">
                                        <div *ngIf="!notification.read" class="unread-indicator"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- User Avatar with Dropdown -->
                <div class="user-dropdown-container">
                    <button class="user-avatar-btn" (click)="toggleUserDropdown()">
                        <img [src]="getAvatarUrl()" [alt]="getCurrentUser()?.username || 'User'" class="nav-avatar" />
                    </button>

                    <!-- User Dropdown Menu -->
                    <div class="user-dropdown" [class.show]="showUserDropdown">
                        <!-- User Info Header -->
                        <div class="user-dropdown-header">
                            <div class="user-info">
                                <div class="user-name">{{ getCurrentUser()?.username || 'User' }}</div>
                                <div class="user-email">{{ getCurrentUser()?.email || 'user@example.com' }}</div>
                            </div>
                        </div>

                        <!-- Dropdown Divider -->
                        <div class="dropdown-divider"></div>

                        <!-- Dropdown Menu Items -->
                        <div class="dropdown-menu">
                            <button class="dropdown-item" (click)="onProfileClick()">
                                <svg class="dropdown-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                                </svg>
                                Profile
                            </button>

                            <button class="dropdown-item sign-out" (click)="onSignOutClick()">
                                <svg class="dropdown-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
                                </svg>
                                Sign out
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>